<main class="lg:max-w-[90%] px-5 py-10 max-sm:py-7 mx-auto">
  <div
    class="flex flex-wrap justify-between items-center gap-4 pb-8 border-b border-gray-200 mb-8 max-sm:hidden"
  >
    <div
      class="flex gap-4 flex-col sm:flex-row justify-between items-center w-full max-sm:mx-auto max-sm:text-center"
    >
      <h1 class="text-3xl font-bold text-foreground text-center sm:text-left">
        My Dashboard
      </h1>
      <div class="flex items-center gap-2">
        <button
          variant="outline"
          hlmBtn
          class="flex items-center gap-2 max-sm:mx-auto sm:py-5.5 sm:px-6 py-4 px-3 sm:text-base group"
          routerLink="/index"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="22"
            height="22"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-arrow-big-left-icon lucide-arrow-big-left transition-transform group-hover:-translate-x-1"
          >
            <path
              d="M13 9a1 1 0 0 1-1-1V5.061a1 1 0 0 0-1.811-.75l-6.835 6.836a1.207 1.207 0 0 0 0 1.707l6.835 6.835a1 1 0 0 0 1.811-.75V16a1 1 0 0 1 1-1h6a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1z"
            />
          </svg>
          <span class="text-base">Back</span>
        </button>

        <button
          routerLink="/create-quiz"
          hlmBtn
          class="flex items-center gap-2 max-sm:mx-auto sm:py-6 sm:px-4 py-5 px-3 sm:text-base"
        >
          <svg
            class="lucide lucide-plus-circle"
            fill="none"
            height="20"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            viewBox="0 0 24 24"
            width="20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" x2="12" y1="8" y2="16"></line>
            <line x1="8" x2="16" y1="12" y2="12"></line>
          </svg>
          <span>Create New Quiz</span>
        </button>
      </div>
    </div>
  </div>
  <ng-container *ngIf="loading; else quizContent">
    <div
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-2 max-sm:mt-0"
    >
      <div
        *ngFor="let _ of [1, 2, 3, 4, 5, 6, 7, 8]"
        class="bg-white min-h-80 rounded-lg shadow-md p-5 animate-pulse"
      >
        <div class="h-full flex flex-col justify-between">
          <div>
            <div class="w-full flex justify-between items-center mb-10">
              <div class="h-6 w-3/4 bg-gray-200 rounded"></div>
              <div class="h-6 w-1/6 bg-gray-200 rounded-full"></div>
            </div>

            <div>
              <div class="h-4 w-full bg-gray-200 rounded mb-2"></div>
              <div class="h-4 w-5/6 bg-gray-200 rounded mb-2"></div>
              <div class="h-4 w-2/3 bg-gray-200 rounded"></div>
            </div>
          </div>
          <div class="h-10 w-full bg-gray-200 rounded mt-auto"></div>
        </div>
      </div>
    </div> </ng-container
  ><ng-template #quizContent>
    <ng-container *ngIf="quizzes && quizzes.length > 0; else noQuiz">
      <div
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-2 max-sm:mt-0"
      >
        <!-- Loop through quizzes -->
        <div
          *ngFor="let quiz of quizzes"
          class="bg-white min-h-80 rounded-lg shadow-md hover:shadow-xl transition-shadow flex flex-col border-l-4"
          [ngClass]="{
            'border-gray-400': quiz.status === 'unpublished',
            'border-primary': quiz.status === 'published',
            'border-yellow-500': quiz.status === 'grading',
            'border-green-600': quiz.status === 'finished'
          }"
        >
          <div class="p-5 flex-grow">
            <div class="flex justify-between items-start mb-2 gap-2">
              <h2 class="text-lg font-semibold text-secondary-foreground mb-1">
                {{ quiz.title }}
              </h2>

              <!-- STATUS BADGES -->
              <span
                class="text-xs font-semibold px-2.5 py-1 rounded-full whitespace-nowrap"
                [ngClass]="{
                  'bg-gray-200 text-gray-700': quiz.status === 'unpublished',
                  'bg-blue-100 text-blue-700': quiz.status === 'published',
                  'bg-yellow-100 text-yellow-700': quiz.status === 'grading',
                  'bg-green-100 text-green-700': quiz.status === 'finished'
                }"
              >
                {{ quiz.status | titlecase }}
              </span>
            </div>

            <!-- Description -->
            <p class="text-sm text-muted-foreground mb-3">
              {{ quiz.description }}
            </p>

            <!-- Info section -->
            <div class="space-y-2 text-sm text-muted-foreground">
              <div class="flex items-center gap-2">
                <svg
                  class="w-4.5 h-4.5 text-gray-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                  ></path>
                </svg>
                <span> {{ quiz.startTime | date : "short" }}</span>
              </div>
              <div class="flex items-center gap-2">
                <svg
                  class="w-4.5 h-4.5 text-gray-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                  ></path>
                </svg>
                <span>{{ quiz.duration }} mins</span>
              </div>
              <div class="flex items-center gap-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-file-text-icon lucide-file-text w-4"
                >
                  <path
                    d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"
                  />
                  <path d="M14 2v4a2 2 0 0 0 2 2h4" />
                  <path d="M10 9H8" />
                  <path d="M16 13H8" />
                  <path d="M16 17H8" />
                </svg>
                <span> {{ quiz.questions.length || 0 }} Questions</span>
              </div>
              <div class="border-b-border border-b-2"></div>

              <!-- Scheduled message -->
              <div
                *ngIf="quiz.status === 'scheduled'"
                class="flex items-center gap-2 text-blue-600 font-medium"
              >
                <span>Scheduled</span>
              </div>

              <!-- Student Finished -->
              <div
                *ngIf="quiz.status === 'grading'"
                class="flex items-center gap-2 text-yellow-600 font-medium"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="22"
                  height="22"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-notebook-pen-icon lucide-notebook-pen"
                >
                  <path
                    d="M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4"
                  />
                  <path d="M2 6h4" />
                  <path d="M2 10h4" />
                  <path d="M2 14h4" />
                  <path d="M2 18h4" />
                  <path
                    d="M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"
                  />
                </svg>
                <span>Grade Student Quiz...</span>
              </div>

              <!-- Finished -->
              <div
                *ngIf="quiz.status === 'finished'"
                class="flex items-center gap-2 text-green-600 font-medium"
              >
                <span>Graded</span>
              </div>
            </div>
          </div>

          <!-- Footer Buttons -->
          <div class="px-5 pb-5 mt-auto space-y-2">
            <!-- UNPUBLISHED â†’ Publish + View -->
            <div *ngIf="quiz.status === 'unpublished'" class="space-y-2">
              <button hlmBtn class="w-full h-10" (click)="publishQuiz(quiz)">
                Publish
              </button>
              <button
                [routerLink]="['/view-detailes', quiz.id]"
                hlmBtn
                variant="outline"
                class="w-full h-10"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="22"
                  height="22"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-list-collapse-icon lucide-list-collapse"
                >
                  <path d="M10 12h11" />
                  <path d="M10 18h11" />
                  <path d="M10 6h11" />
                  <path d="m3 10 3-3-3-3" />
                  <path d="m3 20 3-3-3-3" />
                </svg>
                View Details
              </button>
            </div>

            <!-- PUBLISHED â†’ View only -->
            <button
              [routerLink]="['/view-detailes', quiz.id]"
              *ngIf="quiz.status === 'published'"
              hlmBtn
              variant="outline"
              class="w-full h-10"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="22"
                height="22"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-list-collapse-icon lucide-list-collapse"
              >
                <path d="M10 12h11" />
                <path d="M10 18h11" />
                <path d="M10 6h11" />
                <path d="m3 10 3-3-3-3" />
                <path d="m3 20 3-3-3-3" />
              </svg>
              View Details
            </button>

            <!-- STUDENT_FINISHED â†’ Grade -->
            <button
              *ngIf="quiz.status === 'grading'"
              hlmBtn
              variant="destructive"
              class="w-full h-10"
              (click)="gradeQuiz(quiz)"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="22"
                height="22"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-diamond-plus-icon lucide-diamond-plus"
              >
                <path d="M12 8v8" />
                <path
                  d="M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41L13.7 2.71a2.41 2.41 0 0 0-3.41 0z"
                />
                <path d="M8 12h8" />
              </svg>
              Grade Quiz
            </button>

            <!-- FINISHED â†’ Completed -->
            <div
              *ngIf="quiz.status === 'finished'"
              class="flex w-full justify-center gap-2 items-center p-3 bg-green-100 text-green-700 rounded"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M4 6h16M4 12h16m-7 6h7"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                ></path>
              </svg>
              <span>Completed</span>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-template>

  <ng-template #noQuiz>
    <ng-container>
      <div
        class="flex flex-col items-center justify-center text-center text-muted-foreground pt-16"
      >
        <!-- Better-looking SVG (clipboard with checkmark) -->
        <svg
          class="mx-auto sm:h-60 sm:w-80 h-40 w-60 mb-5"
          viewBox="0 0 200 150"
        >
          <defs>
            <linearGradient
              id="clipboardGradient"
              x1="0%"
              x2="100%"
              y1="0%"
              y2="100%"
            >
              <stop
                offset="0%"
                style="stop-color: #60a5fa; stop-opacity: 1"
              ></stop>
              <stop
                offset="100%"
                style="stop-color: #cbd8ed; stop-opacity: 1"
              ></stop>
            </linearGradient>
          </defs>
          <rect
            fill="#f0f9ff"
            height="120"
            rx="10"
            ry="10"
            stroke="#93c5fd"
            stroke-width="3"
            width="120"
            x="40"
            y="20"
          ></rect>
          <path
            d="M70,20 V10 a5,5 0 0 1 5,-5 h50 a5,5 0 0 1 5,5 v10"
            fill="#e0f2fe"
            stroke="#93c5fd"
            stroke-width="3"
          ></path>
          <rect
            fill="#bfdbfe"
            height="10"
            rx="5"
            ry="5"
            width="40"
            x="80"
            y="5"
          ></rect>
          <line
            stroke="#dbeafe"
            stroke-linecap="round"
            stroke-width="2"
            x1="60"
            x2="140"
            y1="50"
            y2="50"
          ></line>
          <line
            stroke="#dbeafe"
            stroke-linecap="round"
            stroke-width="2"
            x1="60"
            x2="140"
            y1="70"
            y2="70"
          ></line>
          <line
            stroke="#dbeafe"
            stroke-linecap="round"
            stroke-width="2"
            x1="60"
            x2="110"
            y1="90"
            y2="90"
          ></line>
          <g transform="rotate(30, 140, 110)">
            <rect
              fill="#fde047"
              height="60"
              rx="3"
              stroke="#fbbf24"
              stroke-width="2"
              width="10"
              x="125"
              y="70"
            ></rect>
            <polygon fill="#4b5563" points="125,130 135,130 130,140"></polygon>
            <rect fill="#f9a8d4" height="10" width="10" x="125" y="70"></rect>
          </g>
          <circle
            cx="30"
            cy="40"
            fill="url(#clipboardGradient)"
            opacity="0.6"
            r="8"
          ></circle>
          <rect
            fill="none"
            height="15"
            rx="4"
            ry="4"
            stroke="#60a5fa"
            stroke-width="2"
            transform="rotate(20, 172.5, 37.5)"
            width="15"
            x="165"
            y="30"
          ></rect>
          <path
            d="M160 120 l 10 -15 l 10 15 Z"
            fill="#eff6ff"
            stroke="#93c5fd"
            stroke-width="2"
          ></path>
        </svg>

        <!-- Headline -->
        <p class="sm:text-4xl text-3xl font-bold text-foreground">
          Sorry, No Quizzes Available
        </p>

        <!-- Subtext -->

        <div class="flex items-center gap-2 mt-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-hammer-icon lucide-hammer w-7 h-7"
          >
            <path d="m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9" />
            <path d="m18 15 4-4" />
            <path
              d="m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5"
            />
          </svg>
          <p class="sm:text-base text-sm text-gray-500">
            Let's Start to Make a new quizzes.
          </p>
        </div>
      </div>
    </ng-container>
  </ng-template>
</main>
